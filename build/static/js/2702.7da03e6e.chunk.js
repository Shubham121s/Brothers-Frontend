"use strict";(self.webpackChunkBrother_Industrises=self.webpackChunkBrother_Industrises||[]).push([[2702],{12702:(e,t,a)=>{a.r(t),a.d(t,{default:()=>E});var n=a(65043),l=a(49934),s=a(79456),r=a(88705),d=a(33280),o=a(56434),i=a.n(o),c=a(2127),u=a(80907),m=a(62142),h=a(60446),g=a.n(h);const p=(0,u.zD)("attendanceDetail/data/get",async e=>{try{return(await(0,m._4)(e)).data}catch(t){return(null===t||void 0===t?void 0:t.response)||t.toString()}}),x=(0,u.zD)("attendanceDetail/data/total/get",async e=>{try{return(await(0,m.kJ)(e)).data}catch(t){return(null===t||void 0===t?void 0:t.response)||t.toString()}}),v=(0,u.zD)("attendanceDetail/data/monthly/get",async e=>{try{return(await(0,m.PK)(e)).data}catch(t){return(null===t||void 0===t?void 0:t.response)||t.toString()}}),y=(0,u.zD)("attendanceDetail/data/post",async e=>{try{return(await(0,m.ef)(e)).data}catch(t){return(null===t||void 0===t?void 0:t.response)||t.toString()}}),f={month:g()().format("YYYY-MM-DD")},w=(0,u.Z0)({name:"attendanceDetail/data",initialState:{loading:!1,message:"",attendanceList:[],totalAttendance:0,monthlyAttendance:0,tableData:{total:0,pageIndex:1,pageSize:10,query:""},filterData:f},reducers:{setTableData:(e,t)=>{e.tableData=t.payload},setAttendanceList:(e,t)=>{e.attendanceList=t.payload},setFilterData:(e,t)=>{e.filterData=t.payload}},extraReducers:{[p.fulfilled]:(e,t)=>{var a,n;e.loading=!1,e.attendanceList=(null===(a=t.payload)||void 0===a?void 0:a.data)||[],e.tableData.total=(null===(n=t.payload)||void 0===n?void 0:n.total)||0},[p.pending]:e=>{e.loading=!0},[p.rejected]:e=>{e.loading=!1,e.attendanceList=[],e.tableData.total=0},[x.fulfilled]:(e,t)=>{var a;e.totalAttendance=(null===(a=t.payload)||void 0===a?void 0:a.data)||0,e.loading=!1},[x.rejected]:e=>{e.totalAttendance=0,e.loading=!1},[v.fulfilled]:(e,t)=>{var a;e.monthlyAttendance=(null===(a=t.payload)||void 0===a?void 0:a.data)||0,e.loading=!1},[v.rejected]:e=>{e.monthlyAttendance=0,e.loading=!1},[y.fulfilled]:e=>{}}}),{setTableData:j,setAttendanceList:b,setFilterData:k}=w.actions,S=w.reducer;var C=a(70579);const A={present:{label:"Present",dotClass:"bg-emerald-50 text-emerald-500",textClass:"text-emerald-500",content:(0,C.jsx)(c.qHw,{})},absent:{label:"Absent",dotClass:"bg-red-50 text-red-500",textClass:"text-red-500",content:(0,C.jsx)(c.woC,{})},halfday:{label:"Half Day",dotClass:"bg-yellow-50 text-yellow-500",textClass:"text-yellow-500",content:(0,C.jsx)(c.qHw,{})}},D=()=>{const e=(0,s.wA)(),t=(0,n.useMemo)(()=>[{header:"name",accessorKey:"worker_name",cell:e=>{var t;const a=e.row.original;return(0,C.jsx)("div",{className:"flex items-center",children:null===a||void 0===a||null===(t=a.Worker)||void 0===t?void 0:t.worker_name})}},{header:"attended",accessorKey:"worker_attended",cell:e=>{const t=e.row.original;return(0,C.jsxs)("div",{className:"flex items-center",children:[(0,C.jsx)(l.Ex,{innerClass:A[t.worker_attended].dotClass,content:A[t.worker_attended].content,badgeStyle:{width:20,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"19px"}}),(0,C.jsx)("span",{className:`ml-2 font-semibold capitalize ${A[t.worker_attended].textClass}`,children:A[t.worker_attended].label})]})}},{header:"reason",accessorKey:"reason",cell:e=>{const t=e.row.original;return(0,C.jsx)("div",{className:"flex items-center",children:null!==t&&void 0!==t&&t.reason?null===t||void 0===t?void 0:t.reason:"-"})}},{header:"date",accessorKey:"date",cell:e=>{const t=e.row.original;return(0,C.jsx)("div",{className:"flex items-center",children:g()(null===t||void 0===t?void 0:t.date).format("DD/MM/YYYY")})}}],[]),a=(0,d.A)().get("id"),o=(0,s.d4)(e=>e.attendanceList.data.attendanceList),c=(0,s.d4)(e=>e.attendanceList.data.loading),{month:u}=(0,s.d4)(e=>e.attendanceList.data.filterData),{pageIndex:m,pageSize:h,query:x,total:v}=(0,s.d4)(e=>e.attendanceList.data.tableData),y=(0,n.useCallback)(()=>{e(p({pageIndex:m,pageSize:h,query:x,worker_id:a,month:u}))},[m,h,x,a,u]);(0,n.useEffect)(()=>{y()},[m,h,x,u]);const f=(0,n.useMemo)(()=>({pageIndex:m,pageSize:h,query:x,total:v}),[m,h,x,v]);return(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(r.A,{columns:t,data:o,loading:c,pagingData:{pageIndex:m,pageSize:h,query:x,total:v},onPaginationChange:t=>{const a=i()(f);a.pageIndex=t,e(j(a))},onSelectChange:t=>{const a=i()(f);a.pageSize=Number(t),a.pageIndex=1,e(j(a))}})})};var N=a(10813);const z=()=>{const[e,t]=(0,n.useState)(null),[a,r]=(0,n.useState)(null),[o,i]=(0,n.useState)(""),[c,u]=(0,n.useState)(!1),m=(0,d.A)().get("id"),h=(0,s.wA)(),{month:f}=(0,s.d4)(e=>e.attendanceList.data.filterData),w=e=>{r(e)};return(0,C.jsxs)(l.Zp,{children:[(0,C.jsx)("div",{className:"sm:w-[100px] max-w-[420px] mx-auto",children:(0,C.jsx)(N.Vv,{value:e,onChange:t,onMonthChange:e=>h(k({month:g()(e).format("YYYY-MM-DD")})),dayClassName:(e,t)=>{let{selected:a}=t;return a?"text-white":"text-gray-700 dark:text-gray-200 "}})}),(0,C.jsxs)("div",{className:"flex gap-2 justify-center mt-3",children:[(0,C.jsx)(l.$n,{className:" mb-2",variant:"present"===a?"twoTone":"solid",color:"emerald-600",onClick:()=>w("present"),children:"Present"}),(0,C.jsx)(l.$n,{className:" mb-2",variant:"absent"==a?"twoTone":"solid",color:"red-600",onClick:()=>w("absent"),children:"Absent"}),(0,C.jsx)(l.$n,{className:" mb-2",variant:"halfday"==a?"twoTone":"solid",color:"yellow-500",onClick:()=>w("halfday"),children:"Half Day"})]}),"absent"===a&&(0,C.jsx)(l.pd,{placeholder:"Reason",onChange:e=>i(e.target.value)}),(0,C.jsx)("div",{className:"flex justify-center",children:(0,C.jsx)(l.$n,{className:" mb-2 mt-2",variant:"solid",loading:c,color:"blue-600",onClick:()=>(async()=>{if(u(!0),e||(l.y8.push((0,C.jsx)(l.Eg,{title:"Select Date",type:"warning",duration:2500,children:"Please Select Date"}),{placement:"top-end"}),u(!1)),null===a&&(l.y8.push((0,C.jsx)(l.Eg,{title:"Mark Attendance",type:"warning",duration:2500,children:"Mark Attendance"}),{placement:"top-end"}),u(!1)),e&&null!=a){const s=await h(y({worker_id:m,worker_attended:a,date:g()(e).format("YYYY-MM-DD"),reason:o}));var n;!0===s.payload.success?(l.y8.push((0,C.jsx)(l.Eg,{title:"Success",type:"success",duration:2500,children:"Attendance Marked"}),{placement:"top-end"}),t(null),u(!1),r(null),h(p({worker_id:m,month:f})),h(v({worker_id:m,month:f})),h(x({worker_id:m}))):(l.y8.push((0,C.jsx)(l.Eg,{title:"Failed",type:"danger",duration:2500,children:null===(n=s.payload.data)||void 0===n?void 0:n.message}),{placement:"top-end"}),u(!1))}})(),children:c?"Please Wait":"Submit"})})]})};var M=a(89577),I=a(85369),P=a(8860);const _=e=>{let{type:t}=e;switch(t){case"present":return(0,C.jsx)(l.eu,{size:55,className:"bg-indigo-100  text-indigo-600 dark:bg-indigo-500/20 dark:text-indigo-100",icon:(0,C.jsx)(I.hFI,{})});case"absent":return(0,C.jsx)(l.eu,{size:55,className:"bg-cyan-100 text-cyan-600 dark:bg-cyan-500/20 dark:text-cyan-100",icon:(0,C.jsx)(P.gtt,{})});default:return(0,C.jsx)("div",{})}},T=e=>{let{data:t=0,label:a,valuePrefix:n,type:s}=e;return(0,C.jsx)(l.Zp,{className:"",children:(0,C.jsxs)("div",{className:"flex items-center gap-4",children:[(0,C.jsx)(_,{type:s}),(0,C.jsxs)("div",{children:[(0,C.jsx)("div",{className:"flex gap-1.5 items-end mb-2",children:(0,C.jsx)("p",{className:"font-semibold ",children:a})}),(0,C.jsx)("div",{children:(0,C.jsx)("h3",{className:"font-bold",children:(0,C.jsx)(M.HG,{displayType:"text",value:t,thousandSeparator:",",prefix:n})})})]})]})})},Y=()=>{const e=(0,s.wA)(),t=(0,d.A)().get("id"),a=(0,s.d4)(e=>e.attendanceList.data.totalAttendance),l=(0,s.d4)(e=>e.attendanceList.data.monthlyAttendance),{month:r}=(0,s.d4)(e=>e.attendanceList.data.filterData);(0,n.useEffect)(()=>{o()},[r]);const o=()=>{e(v({worker_id:t,month:r})),e(x({worker_id:t}))};return(0,C.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[(0,C.jsx)(T,{data:a,label:"Total Attendance",type:"present"}),(0,C.jsx)(T,{data:l,label:"Monthly Attendance",type:"absent"})]})};var L=a(24603);const R=(0,a(50805).HY)({data:S});var H=a(27176);(0,L.Mh)("attendanceList",R);const E=()=>(0,C.jsxs)(H.r5,{className:"h-full",bodyClass:"h-full",children:[(0,C.jsx)("h4",{className:"mb-4",children:"Mark Attendance"}),(0,C.jsx)("div",{className:"mt-4"}),(0,C.jsx)("div",{className:"mt-4",children:(0,C.jsx)(Y,{})}),(0,C.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[(0,C.jsx)("div",{className:"col-span-1",children:(0,C.jsx)(z,{})}),(0,C.jsx)("div",{className:"col-span-2",children:(0,C.jsx)(l.Zp,{children:(0,C.jsx)(D,{})})})]})]})},62142:(e,t,a)=>{a.d(t,{$k:()=>m,MA:()=>l,Mn:()=>g,PK:()=>c,Pg:()=>r,_4:()=>o,ef:()=>u,kJ:()=>i,qF:()=>s,qv:()=>d,r1:()=>h});var n=a(43971);async function l(e){return n.A.fetchData({url:"v1/web/company/worker",method:"get",params:e})}async function s(e){return n.A.fetchData({url:"v1/web/company/worker/register",method:"post",data:e})}async function r(e){return n.A.fetchData({url:"v1/web/company/worker/update/id",method:"put",data:e})}async function d(e){return n.A.fetchData({url:"v1/web/company/worker/delete/id",method:"delete",data:e})}async function o(e){return n.A.fetchData({url:"v1/web/company/worker/attendance/id",method:"post",data:e})}async function i(e){return n.A.fetchData({url:"v1/web/company/worker/attendance/total/id",method:"post",data:e})}async function c(e){return n.A.fetchData({url:"v1/web/company/worker/attendance/monthly/id",method:"post",data:e})}async function u(e){return n.A.fetchData({url:"v1/web/company/worker/attendance/register/id",method:"post",data:e})}async function m(e){return n.A.fetchData({url:"v1/web/company/worker/ledger",method:"post",data:e})}async function h(e){return n.A.fetchData({url:"v1/web/company/worker/id",method:"post",data:e})}async function g(e){return n.A.fetchData({url:"v1/web/company/worker/ledger/pay",method:"post",data:e})}},88705:(e,t,a)=>{a.d(t,{A:()=>k});var n=a(65043),l=a(98139),s=a.n(l),r=a(49934),d=a(70579);const{Tr:o,Td:i,TBody:c}=r.XI,u=e=>{const{columns:t,rows:a,avatarInColumns:n,avatarProps:l}=e;return(0,d.jsx)(c,{children:Array.from(new Array(a),(e,t)=>t+0).map(e=>(0,d.jsx)(o,{children:Array.from(new Array(t),(e,t)=>t+0).map(e=>(0,d.jsx)(i,{children:(0,d.jsxs)("div",{className:"flex flex-auto items-center gap-2",children:[n.includes(e)&&(0,d.jsx)("div",{children:(0,d.jsx)(r.EA,{variant:"circle",...l})}),(0,d.jsx)(r.EA,{})]})},`col-${e}`))},`row-${e}`))})};u.defaultProps={columns:1,rows:10,avatarInColumns:[]};const m=u;var h=a(6023),g=a(58931),p=a(47111);const{Tr:x,Th:v,Td:y,THead:f,TBody:w}=r.XI,j=e=>{const{indeterminate:t,onChange:a,onCheckBoxChange:l,onIndeterminateCheckBoxChange:s,...o}=e,i=(0,n.useRef)(null);(0,n.useEffect)(()=>{"boolean"===typeof t&&(i.current.indeterminate=!o.checked&&t)},[i,t]);return(0,d.jsx)(r.Sc,{className:"mb-0",ref:i,onChange:(e,t)=>(e=>{a(e),null===l||void 0===l||l(e),null===s||void 0===s||s(e)})(t),...o})},b=(0,n.forwardRef)((e,t)=>{const{skeletonAvatarColumns:a,columns:l,data:o,loading:i,onCheckBoxChange:c,onIndeterminateCheckBoxChange:u,onPaginationChange:b,onSelectChange:k,onSort:S,pageSizes:C,selectable:A,skeletonAvatarProps:D,pagingData:N,tableWidth:z="100%"}=e,{pageSize:M,pageIndex:I,total:P}=N,[_,T]=(0,n.useState)(null),Y=(0,n.useMemo)(()=>C.map(e=>({value:e,label:`${e} / page`})),[C]);(0,n.useEffect)(()=>{if(Array.isArray(_)){const e=_.length>0?_[0].desc?"desc":"asc":"",t=_.length>0?_[0].id:"";null===S||void 0===S||S({order:e,key:t})}},[_]);const L=l.some(e=>e.Header||e.accessor||e.Cell),R=(0,n.useMemo)(()=>{const e=l.map(e=>({...e,size:e.size||void 0,minSize:e.minSize||100,maxSize:e.maxSize||300}));return A?[{id:"select",header:e=>{let{table:t}=e;return(0,d.jsx)(j,{checked:t.getIsAllRowsSelected(),indeterminate:t.getIsSomeRowsSelected(),onChange:t.getToggleAllRowsSelectedHandler(),onIndeterminateCheckBoxChange:e=>{var a,n;a=e.target.checked,n=t.getRowModel().rows,i||null===u||void 0===u||u(a,n)}})},cell:e=>{let{row:t}=e;return(0,d.jsx)(j,{checked:t.getIsSelected(),disabled:!t.getCanSelect(),indeterminate:t.getIsSomeSelected(),onChange:t.getToggleSelectedHandler(),onCheckBoxChange:e=>((e,t)=>{i||null===c||void 0===c||c(e,t)})(e.target.checked,t.original)})},size:50,minSize:50,maxSize:50},...e]:e},[l,A]),H=(0,g.N4)({data:o,columns:L?[]:R,getCoreRowModel:(0,p.HT)(),getFilteredRowModel:(0,p.hM)(),getPaginationRowModel:(0,p.kW)(),getSortedRowModel:(0,p.h5)(),manualPagination:!0,manualSorting:!0,onSortingChange:T,state:{sorting:_},columnResizeMode:"onChange"}),E=()=>{H.resetSorting()},$=()=>{H.toggleAllRowsSelected(!1)};if((0,n.useImperativeHandle)(t,()=>({resetSorting:E,resetSelected:$})),L){const e="You are using old react-table v7 column config, please use v8 column config instead, refer to our demo or https://tanstack.com/table/v8";return(0,d.jsx)(r.Fc,{children:e})}return(0,d.jsxs)(h.A,{loading:i&&0!==o.length,type:"cover",children:[(0,d.jsx)("div",{style:{width:z,overflowX:"auto"},children:(0,d.jsxs)(r.XI,{style:{width:"100%",tableLayout:"fixed"},children:[(0,d.jsx)(f,{children:H.getHeaderGroups().map(e=>(0,d.jsx)(x,{children:e.headers.map(e=>(0,d.jsx)(v,{colSpan:e.colSpan,style:{width:`${e.column.getSize()}px`},children:e.isPlaceholder?null:(0,d.jsx)("div",{className:s()(i&&"pointer-events-none"),children:(0,g.Kv)(e.column.columnDef.header,e.getContext())})},e.id))},e.id))}),i&&0===o.length?(0,d.jsx)(m,{columns:R.length,rows:N.pageSize,avatarInColumns:a,avatarProps:D}):(0,d.jsx)(w,{children:H.getRowModel().rows.slice(0,M).map(e=>(0,d.jsx)(x,{children:e.getVisibleCells().map(e=>(0,d.jsx)(y,{style:{width:`${e.column.getSize()}px`},children:(0,g.Kv)(e.column.columnDef.cell,e.getContext())},e.id))},e.id))})]})}),(0,d.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,d.jsx)(r.dK,{pageSize:M,currentPage:I,total:P,onChange:e=>{i||null===b||void 0===b||b(e)}}),(0,d.jsx)("div",{style:{minWidth:130},children:(0,d.jsx)(r.l6,{size:"sm",menuPlacement:"top",isSearchable:!1,value:Y.filter(e=>e.value===M),options:Y,onChange:e=>{return t=e.value,void(i||null===k||void 0===k||k(Number(t)));var t}})})]})]})});b.defaultProps={pageSizes:[10,25,50,100],pagingData:{total:0,pageIndex:1,pageSize:10},data:[],columns:[],selectable:!1,loading:!1};const k=b}}]);
//# sourceMappingURL=2702.7da03e6e.chunk.js.map